<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PART 4: ëŒ€ì‹œë³´ë“œ</title>
    <link rel="stylesheet" href="common.css">
    <style>
        /* Part 4 í…Œë§ˆ ìƒ‰ìƒ */
        :root {
            --accent-color: #a855f7;
            --accent-text-color: white;
            --section-title-color: #c084fc;
            --section-title-hover-bg: rgba(168, 85, 247, 0.2);
        }

        /* ëŒ€ì‹œë³´ë“œ ë¯¸ë¦¬ë³´ê¸° */
        .dashboard-preview {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1.5em;
            margin: 1.5em 0;
            border: 2px solid #ddd;
        }

        .dashboard-header {
            background: #a855f7;
            color: white;
            padding: 0.8em 1em;
            border-radius: 8px 8px 0 0;
            font-weight: 600;
            margin: -1.5em -1.5em 1em -1.5em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1em;
            margin-bottom: 1.5em;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 1.2em;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #a855f7;
        }

        .stat-card.blue { border-left-color: #3498db; }
        .stat-card.green { border-left-color: #27ae60; }
        .stat-card.orange { border-left-color: #e67e22; }
        .stat-card.red { border-left-color: #e74c3c; }

        .stat-card .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #2c3e50;
        }

        .stat-card .stat-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 0.3em;
        }

        .recent-table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .recent-table-header {
            background: #ecf0f1;
            padding: 0.8em 1em;
            font-weight: 600;
            color: #2c3e50;
        }

        /* ìœ„ì ¯ ë‹¤ì´ì–´ê·¸ë¨ */
        .widget-diagram {
            display: flex;
            flex-wrap: wrap;
            gap: 1em;
            justify-content: center;
            padding: 1.5em;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 1em 0;
        }

        .widget-block {
            background: white;
            border: 2px solid #a855f7;
            border-radius: 8px;
            padding: 1em 1.5em;
            text-align: center;
            min-width: 120px;
        }

        .widget-block.stats {
            border-color: #3498db;
            background: #e8f4fd;
        }

        .widget-block.table {
            border-color: #e67e22;
            background: #fef5e7;
        }

        .widget-block .icon {
            font-size: 2em;
            margin-bottom: 0.3em;
        }

        .widget-block .label {
            font-weight: 600;
            color: #2c3e50;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1em 0;
        }

        .comparison-table th,
        .comparison-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background: #a855f7;
            color: white;
            font-weight: 600;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .step-number {
            display: inline-block;
            min-width: 32px;
            width: 32px;
            height: 32px;
            background: #a855f7;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            font-weight: 700;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .steps-list {
            list-style: none;
            padding-left: 0;
        }

        .steps-list li {
            margin-bottom: 1.5em;
            display: flex;
            align-items: flex-start;
        }

        .steps-list .step-content {
            flex: 1;
        }

        .checklist {
            list-style: none;
            margin-left: 0;
        }

        .checklist li {
            padding: 0.5em 0;
            padding-left: 2em;
            position: relative;
        }

        .checklist li::before {
            content: "â˜";
            position: absolute;
            left: 0;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav>
        <h1>PART 4: ëŒ€ì‹œë³´ë“œ</h1>
        <ul class="nav-accordion">
            <li class="nav-section">
                <a href="#intro" class="section-title">ì‹œì‘í•˜ê¸°</a>
                <ul class="subsections">
                    <li><a href="#goal">ì˜¤ëŠ˜ì˜ ëª©í‘œ</a></li>
                    <li><a href="#recap">ì§€ê¸ˆê¹Œì§€ ë§Œë“  ê²ƒ</a></li>
                </ul>
            </li>
            <li class="nav-section">
                <a href="#widget-concept" class="section-title">Widget ê°œë…</a>
                <ul class="subsections">
                    <li><a href="#widget-what">Widgetì´ë€</a></li>
                    <li><a href="#widget-types">Widget ì¢…ë¥˜</a></li>
                </ul>
            </li>
            <li class="nav-section">
                <a href="#stats-widget" class="section-title">í†µê³„ ì¹´ë“œ</a>
                <ul class="subsections">
                    <li><a href="#stats-create">Widget ìƒì„±</a></li>
                    <li><a href="#stats-code">ì½”ë“œ ì‘ì„±</a></li>
                </ul>
            </li>
            <li class="nav-section">
                <a href="#table-widget" class="section-title">í…Œì´ë¸” ìœ„ì ¯</a>
                <ul class="subsections">
                    <li><a href="#table-create">Widget ìƒì„±</a></li>
                    <li><a href="#table-code">ì½”ë“œ ì‘ì„±</a></li>
                </ul>
            </li>
            <li class="nav-section">
                <a href="#practice" class="section-title">ì‹¤ìŠµ</a>
            </li>
            <li class="nav-section">
                <a href="#checkpoint" class="section-title">ì²´í¬í¬ì¸íŠ¸</a>
            </li>
        </ul>
    </nav>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main>
        <!-- íƒ€ì´í‹€ -->
        <section class="title-section" id="intro">
            <h1>PART 4</h1>
            <h2>ëŒ€ì‹œë³´ë“œ - í˜„í™©íŒ ë§Œë“¤ê¸°</h2>
            <p><span class="text-highlight">ìˆ«ìê°€ í•œëˆˆì— ë³´ì´ëŠ” í˜„í™©íŒ</span></p>
            <p style="margin-top: 2em; color: #95a5a6;">40ë¶„</p>
        </section>

        <!-- ì˜¤ëŠ˜ì˜ ëª©í‘œ -->
        <section id="goal">
            <h2>ì˜¤ëŠ˜ì˜ ëª©í‘œ</h2>
            <div class="highlight">
                <p><strong>Widgetìœ¼ë¡œ ë°ì´í„° ì‹œê°í™”í•˜ê¸°</strong></p>
            </div>

            <div class="dashboard-preview">
                <div class="dashboard-header">ëŒ€ì‹œë³´ë“œ</div>
                <div class="stats-grid">
                    <div class="stat-card blue">
                        <div class="stat-value">3</div>
                        <div class="stat-label">ì´ ê³ ê°</div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-value">3</div>
                        <div class="stat-label">ì´ ì‹œìˆ </div>
                    </div>
                    <div class="stat-card orange">
                        <div class="stat-value">135,000</div>
                        <div class="stat-label">ì´ ë§¤ì¶œ</div>
                    </div>
                    <div class="stat-card red">
                        <div class="stat-value">45,000</div>
                        <div class="stat-label">í‰ê·  ê°ë‹¨ê°€</div>
                    </div>
                </div>
                <div class="recent-table">
                    <div class="recent-table-header">ìµœê·¼ ì‹œìˆ  ë‚´ì—­</div>
                    <table class="comparison-table" style="margin: 0;">
                        <thead>
                            <tr>
                                <th>ë‚ ì§œ</th>
                                <th>ê³ ê°</th>
                                <th>ì‹œìˆ </th>
                                <th>ê¸ˆì•¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>12/05</td>
                                <td>ê¹€ì„œì—°</td>
                                <td>ì—¼ìƒ‰</td>
                                <td>80,000ì›</td>
                            </tr>
                            <tr>
                                <td>12/02</td>
                                <td>ì´ì¤€í˜¸</td>
                                <td>ë‚¨ì„±ì»¤íŠ¸</td>
                                <td>20,000ì›</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- ì§€ê¸ˆê¹Œì§€ ë§Œë“  ê²ƒ -->
        <section id="recap">
            <h2>ì§€ê¸ˆê¹Œì§€ ë§Œë“  ê²ƒ</h2>

            <div class="two-column">
                <div>
                    <h3>PART 2: ê³ ê° í…Œì´ë¸”</h3>
                    <div style="background: #f8f9fa; padding: 1em; border-radius: 8px; border-left: 4px solid #3498db;">
                        <strong>customers</strong><br>
                        id, name, phone, birth_date, gender, memo
                    </div>
                </div>
                <div>
                    <h3>PART 3: ì‹œìˆ ë‚´ì—­ í…Œì´ë¸”</h3>
                    <div style="background: #e8f8f5; padding: 1em; border-radius: 8px; border-left: 4px solid #27ae60;">
                        <strong>treatments</strong><br>
                        id, customer_id, treatment_date, treatment_type, price
                    </div>
                </div>
            </div>

            <div class="tip" style="margin-top: 1.5em; text-align: center;">
                <p>ì´ ë°ì´í„°ë“¤ì„ <strong>ëŒ€ì‹œë³´ë“œì—ì„œ í•œëˆˆì—</strong> ë³´ì—¬ì¤ë‹ˆë‹¤!</p>
            </div>
        </section>

        <!-- Widget ê°œë… -->
        <section id="widget-concept" class="section-divider">
            <h2>Widget ê°œë…</h2>
            <p>ëŒ€ì‹œë³´ë“œì˜ ë ˆê³  ë¸”ë¡</p>
        </section>

        <!-- Widgetì´ë€ -->
        <section id="widget-what">
            <h2>Widgetì´ë€?</h2>

            <div class="highlight">
                <p><strong>Widget = ëŒ€ì‹œë³´ë“œì— í‘œì‹œë˜ëŠ” ì •ë³´ ì¹´ë“œ</strong></p>
                <p>ë ˆê³  ë¸”ë¡ì²˜ëŸ¼ ì¡°í•©í•´ì„œ ëŒ€ì‹œë³´ë“œë¥¼ êµ¬ì„±</p>
            </div>

            <div class="widget-diagram">
                <div class="widget-block stats">
                    <div class="icon">ğŸ“Š</div>
                    <div class="label">í†µê³„ ì¹´ë“œ</div>
                </div>
                <div class="widget-block table">
                    <div class="icon">ğŸ“‹</div>
                    <div class="label">í…Œì´ë¸”</div>
                </div>
            </div>

            <div class="tip">
                <p>ì˜¤ëŠ˜ì€ <strong>í†µê³„ ì¹´ë“œ</strong>ì™€ <strong>í…Œì´ë¸” ìœ„ì ¯</strong>ì„ ë§Œë“­ë‹ˆë‹¤!</p>
            </div>
        </section>

        <!-- Widget ì¢…ë¥˜ -->
        <section id="widget-types">
            <h2>Filament Widget ì¢…ë¥˜</h2>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ì¢…ë¥˜</th>
                        <th>ìš©ë„</th>
                        <th>ì˜ˆì‹œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>StatsOverviewWidget</strong></td>
                        <td>ìˆ«ì í†µê³„ í‘œì‹œ</td>
                        <td>ì´ ê³ ê° ìˆ˜, ë§¤ì¶œ í•©ê³„</td>
                    </tr>
                    <tr>
                        <td><strong>TableWidget</strong></td>
                        <td>í…Œì´ë¸” í˜•íƒœ ë°ì´í„°</td>
                        <td>ìµœê·¼ ì‹œìˆ  ë‚´ì—­</td>
                    </tr>
                    <tr>
                        <td><strong>ChartWidget</strong></td>
                        <td>ì°¨íŠ¸ ê·¸ë˜í”„</td>
                        <td>ì›”ë³„ ë§¤ì¶œ ì¶”ì´ (ì‹¬í™”)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- í†µê³„ ì¹´ë“œ -->
        <section id="stats-widget" class="section-divider">
            <h2>í†µê³„ ì¹´ë“œ Widget</h2>
            <p>ìˆ«ìë¡œ í˜„í™©ì„ í•œëˆˆì—</p>
        </section>

        <!-- Widget ìƒì„± -->
        <section id="stats-create">
            <h2>StatsOverview Widget ìƒì„±</h2>

            <div class="code-block">
                <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                <pre><code>sail artisan make:filament-widget StatsOverview --stats-overview</code></pre>
            </div>

            <div class="tip">
                <p><code>--stats-overview</code> ì˜µì…˜ìœ¼ë¡œ í†µê³„ ì¹´ë“œ ì „ìš© ìœ„ì ¯ ìƒì„±!</p>
            </div>
        </section>

        <!-- ì½”ë“œ ì‘ì„± -->
        <section id="stats-code">
            <h2>StatsOverview ì½”ë“œ</h2>

            <div class="code-block">
                <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                <pre><code>&lt;?php

namespace App\Filament\Widgets;

use App\Models\Customer;
use App\Models\Treatment;
use Filament\Widgets\StatsOverviewWidget as BaseWidget;
use Filament\Widgets\StatsOverviewWidget\Stat;
use Carbon\Carbon;

class StatsOverview extends BaseWidget
{
    protected function getStats(): array
    {
        $startOfMonth = Carbon::now()->startOfMonth();

        return [
            Stat::make('ì´ ê³ ê° ìˆ˜', Customer::count())
                ->description('ë“±ë¡ëœ ì „ì²´ ê³ ê°')
                ->color('primary'),

            Stat::make('ì´ ì‹œìˆ  ê±´ìˆ˜', Treatment::count())
                ->description('ì „ì²´ ì‹œìˆ  ë‚´ì—­')
                ->color('success'),

            Stat::make('ì´ë²ˆ ë‹¬ ë§¤ì¶œ', number_format(
                Treatment::where('treatment_date', '>=', $startOfMonth)->sum('price')
            ) . 'ì›')
                ->description(Carbon::now()->format('Yë…„ mì›”'))
                ->color('warning'),

            Stat::make('í‰ê·  ê°ë‹¨ê°€', number_format(
                Treatment::avg('price') ?? 0
            ) . 'ì›')
                ->description('ì‹œìˆ  1ê±´ë‹¹ í‰ê· ')
                ->color('danger'),
        ];
    }
}</code></pre>
            </div>

            <h3>Eloquent ì¿¼ë¦¬ = ì—‘ì…€ ìˆ˜ì‹</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>ì—‘ì…€</th>
                        <th>Eloquent</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>=COUNTA(A:A)</code></td>
                        <td><code>Customer::count()</code></td>
                    </tr>
                    <tr>
                        <td><code>=SUM(E:E)</code></td>
                        <td><code>Treatment::sum('price')</code></td>
                    </tr>
                    <tr>
                        <td><code>=AVERAGE(E:E)</code></td>
                        <td><code>Treatment::avg('price')</code></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- í…Œì´ë¸” ìœ„ì ¯ -->
        <section id="table-widget" class="section-divider">
            <h2>í…Œì´ë¸” Widget</h2>
            <p>ìµœê·¼ ë°ì´í„°ë¥¼ ëª©ë¡ìœ¼ë¡œ</p>
        </section>

        <!-- í…Œì´ë¸” Widget ìƒì„± -->
        <section id="table-create">
            <h2>RecentTreatments Widget ìƒì„±</h2>

            <div class="code-block">
                <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                <pre><code>sail artisan make:filament-widget RecentTreatments --table</code></pre>
            </div>

            <div class="tip">
                <p><code>--table</code> ì˜µì…˜ìœ¼ë¡œ í…Œì´ë¸” í˜•íƒœ ìœ„ì ¯ ìƒì„±!</p>
            </div>
        </section>

        <!-- í…Œì´ë¸” ì½”ë“œ -->
        <section id="table-code">
            <h2>RecentTreatments ì½”ë“œ</h2>

            <div class="code-block">
                <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                <pre><code>&lt;?php

namespace App\Filament\Widgets;

use App\Models\Treatment;
use Filament\Tables;
use Filament\Tables\Table;
use Filament\Widgets\TableWidget as BaseWidget;

class RecentTreatments extends BaseWidget
{
    protected static ?string $heading = 'ìµœê·¼ ì‹œìˆ  ë‚´ì—­';

    protected int | string | array $columnSpan = 'full';

    public function table(Table $table): Table
    {
        return $table
            ->query(
                Treatment::query()->latest('treatment_date')->limit(5)
            )
            ->columns([
                Tables\Columns\TextColumn::make('treatment_date')
                    ->label('ë‚ ì§œ')
                    ->date('m/d'),

                Tables\Columns\TextColumn::make('customer.name')
                    ->label('ê³ ê°ëª…'),

                Tables\Columns\TextColumn::make('treatment_type')
                    ->label('ì‹œìˆ '),

                Tables\Columns\TextColumn::make('price')
                    ->label('ê¸ˆì•¡')
                    ->money('KRW'),
            ])
            ->paginated(false);
    }
}</code></pre>
            </div>

            <div class="tip">
                <p><code>customer.name</code> - PART 3ì—ì„œ ì„¤ì •í•œ ê´€ê³„ë¥¼ í†µí•´ ê³ ê° ì´ë¦„ í‘œì‹œ!</p>
            </div>
        </section>

        <!-- ì‹¤ìŠµ -->
        <section id="practice" class="section-divider">
            <h2>ì‹¤ìŠµ</h2>
            <p>ì§ì ‘ ë§Œë“¤ì–´ë´…ì‹œë‹¤</p>
        </section>

        <section>
            <h2>ì‹¤ìŠµ: Widget ë§Œë“¤ê¸°</h2>

            <ol class="steps-list">
                <li>
                    <span class="step-number">1</span>
                    <div class="step-content">
                        <strong>í†µê³„ ì¹´ë“œ Widget ìƒì„±</strong>
                        <div class="code-block">
                            <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                            <pre><code>sail artisan make:filament-widget StatsOverview --stats-overview</code></pre>
                        </div>
                    </div>
                </li>
                <li>
                    <span class="step-number">2</span>
                    <div class="step-content">
                        <strong>ì½”ë“œ ì‘ì„±</strong><br>
                        app/Filament/Widgets/StatsOverview.php
                    </div>
                </li>
                <li>
                    <span class="step-number">3</span>
                    <div class="step-content">
                        <strong>í…Œì´ë¸” Widget ìƒì„±</strong>
                        <div class="code-block">
                            <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                            <pre><code>sail artisan make:filament-widget RecentTreatments --table</code></pre>
                        </div>
                    </div>
                </li>
                <li>
                    <span class="step-number">4</span>
                    <div class="step-content">
                        <strong>ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸</strong>
                        <div class="code-block">
                            <button class="copy-button" onclick="copyCode(this)">ë³µì‚¬</button>
                            <pre><code>http://localhost/admin</code></pre>
                        </div>
                    </div>
                </li>
            </ol>
        </section>

        <!-- ì²´í¬í¬ì¸íŠ¸ -->
        <section id="checkpoint">
            <h2>PART 4 ì²´í¬í¬ì¸íŠ¸</h2>

            <ul class="checklist">
                <li>Widget ê°œë… ì´í•´</li>
                <li>StatsOverview Widget ìƒì„±</li>
                <li>4ê°œ í†µê³„ ì¹´ë“œ êµ¬í˜„</li>
                <li>RecentTreatments Widget ìƒì„±</li>
                <li>ìµœê·¼ ì‹œìˆ  5ê±´ í‘œì‹œ</li>
                <li>ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸</li>
            </ul>

            <div class="highlight" style="margin-top: 2em; text-align: center;">
                <p style="font-size: 1.5em;"><strong>ì¶•í•˜í•©ë‹ˆë‹¤!</strong></p>
                <p style="font-size: 1.1em; margin-top: 0.5em;">ë¯¸ìš©ì‹¤ CRMì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</p>
            </div>

            <div class="dashboard-preview" style="margin-top: 2em;">
                <div class="dashboard-header">ì™„ì„±ëœ ì‹œìŠ¤í…œ</div>
                <table class="comparison-table" style="margin: 0;">
                    <thead>
                        <tr>
                            <th>PART</th>
                            <th>ë§Œë“  ê²ƒ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>PART 1</td>
                            <td>í™˜ê²½ ì„¤ì • + Filament ì„¤ì¹˜</td>
                        </tr>
                        <tr>
                            <td>PART 2</td>
                            <td>ê³ ê° í…Œì´ë¸”</td>
                        </tr>
                        <tr>
                            <td>PART 3</td>
                            <td>ì‹œìˆ ë‚´ì—­ í…Œì´ë¸” + ê´€ê³„ ì„¤ì •</td>
                        </tr>
                        <tr>
                            <td>PART 4</td>
                            <td>ëŒ€ì‹œë³´ë“œ ìœ„ì ¯ (í†µê³„ + í…Œì´ë¸”)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <script>
        function copyCode(button) {
            const codeBlock = button.parentElement.querySelector('code');
            const text = codeBlock.innerText;
            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'ë³µì‚¬ë¨!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = 'ë³µì‚¬';
                    button.classList.remove('copied');
                }, 2000);
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('section[id]');
            const navSections = document.querySelectorAll('.nav-section');
            const navLinks = document.querySelectorAll('nav a');

            navSections.forEach(navSection => {
                const title = navSection.querySelector('.section-title');
                title.addEventListener('click', function(e) {
                    navSections.forEach(ns => {
                        if (ns !== navSection) ns.classList.remove('open');
                    });
                    navSection.classList.toggle('open');
                });
            });

            function activateLink() {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (scrollY >= sectionTop - 100) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.add('active');
                        const parentSection = link.closest('.nav-section');
                        if (parentSection) {
                            navSections.forEach(ns => ns.classList.remove('open'));
                            parentSection.classList.add('open');
                        }
                    }
                });
            }

            window.addEventListener('scroll', activateLink);
            activateLink();
            if (navSections.length > 0) {
                navSections[0].classList.add('open');
            }
        });
    </script>
</body>
</html>
